"""MAC address OUI (vendor) lookup."""

# Common OUI prefixes for vendor identification
# Format: First 3 bytes of MAC (uppercase, no colons) -> Vendor name
OUI_DATABASE: dict[str, str] = {
    # Apple
    "00A040": "Apple",
    "000A27": "Apple",
    "000A95": "Apple",
    "000D93": "Apple",
    "0010FA": "Apple",
    "001124": "Apple",
    "001451": "Apple",
    "0016CB": "Apple",
    "0017F2": "Apple",
    "0019E3": "Apple",
    "001B63": "Apple",
    "001CB3": "Apple",
    "001D4F": "Apple",
    "001E52": "Apple",
    "001EC2": "Apple",
    "001F5B": "Apple",
    "001FF3": "Apple",
    "002241": "Apple",
    "002312": "Apple",
    "002332": "Apple",
    "00236C": "Apple",
    "002436": "Apple",
    "00254B": "Apple",
    "002608": "Apple",
    "0026B0": "Apple",
    "0026BB": "Apple",
    "003065": "Apple",
    "003EE1": "Apple",
    "0050E4": "Apple",
    "006171": "Apple",
    "006D52": "Apple",
    "00B362": "Apple",
    "00C610": "Apple",
    "00CDFE": "Apple",
    "00F4B9": "Apple",
    "00F76F": "Apple",
    "041552": "Apple",
    "042665": "Apple",
    "04489A": "Apple",
    "044BED": "Apple",
    "0452F3": "Apple",
    "045453": "Apple",
    "046C59": "Apple",
    "04D3CF": "Apple",
    "04DB56": "Apple",
    "04E536": "Apple",
    "04F7E4": "Apple",
    "086698": "Apple",
    "086D41": "Apple",
    "0C74C2": "Apple",
    "0CBC9F": "Apple",
    "10DDB1": "Apple",
    "14109F": "Apple",
    "182032": "Apple",
    "24AB81": "Apple",
    "28E02C": "Apple",
    "2C1F23": "Apple",
    "34363B": "Apple",
    "38C986": "Apple",
    "3C0754": "Apple",
    "403004": "Apple",
    "442A60": "Apple",
    "48437C": "Apple",
    "4860BC": "Apple",
    "503237": "Apple",
    "542696": "Apple",
    "54724F": "Apple",
    "54AE27": "Apple",
    "58B035": "Apple",
    "5C59AB": "Apple",
    "5C969D": "Apple",
    "5CF5DA": "Apple",
    "60C547": "Apple",
    "648099": "Apple",
    "64A5C3": "Apple",
    "680927": "Apple",
    "6C3E6D": "Apple",
    "6C94F8": "Apple",
    "70DEE2": "Apple",
    "749EAF": "Apple",
    "783A84": "Apple",
    "78A3E4": "Apple",
    "7C11BE": "Apple",
    "7CC537": "Apple",
    "80006E": "Apple",
    "80929F": "Apple",
    "84788B": "Apple",
    "848506": "Apple",
    "8866A5": "Apple",
    "885395": "Apple",
    "8C006D": "Apple",
    "8C2DAA": "Apple",
    "8C7B9D": "Apple",
    "8C8590": "Apple",
    "90840D": "Apple",
    "9803D8": "Apple",
    "98D6BB": "Apple",
    "98E0D9": "Apple",
    "98F0AB": "Apple",
    "9C207B": "Apple",
    "9CF387": "Apple",
    "A01828": "Apple",
    "A43135": "Apple",
    "A4D1D2": "Apple",
    "A860B6": "Apple",
    "A88808": "Apple",
    "AC3C0B": "Apple",
    "B065BD": "Apple",
    "B418D1": "Apple",
    "B8098A": "Apple",
    "B817C2": "Apple",
    "BC3BAF": "Apple",
    "BC6778": "Apple",
    "C01ADA": "Apple",
    "C8334B": "Apple",
    "C86F1D": "Apple",
    "CC088D": "Apple",
    "D023DB": "Apple",
    "D02598": "Apple",
    "D49A20": "Apple",
    "D83062": "Apple",
    "D89695": "Apple",
    "D89E3F": "Apple",
    "DC2B2A": "Apple",
    "DC2B61": "Apple",
    "E0C767": "Apple",
    "E425E7": "Apple",
    "E80688": "Apple",
    "E8040B": "Apple",
    "E89120": "Apple",
    "ECD09F": "Apple",
    "F02475": "Apple",
    "F07960": "Apple",
    "F0B479": "Apple",
    "F0C1F1": "Apple",
    "F0D1A9": "Apple",
    "F0DCE2": "Apple",
    "F40F24": "Apple",
    "F45C89": "Apple",
    "F8E079": "Apple",
    "FC253F": "Apple",
    # Samsung
    "00125A": "Samsung",
    "0015B9": "Samsung",
    "001632": "Samsung",
    "001699": "Samsung",
    "0017D5": "Samsung",
    "0018AF": "Samsung",
    "001A8A": "Samsung",
    "001EE1": "Samsung",
    "001EE2": "Samsung",
    "002119": "Samsung",
    "002339": "Samsung",
    "002491": "Samsung",
    "00265D": "Samsung",
    "00E3B2": "Samsung",
    "08D42B": "Samsung",
    "10D38A": "Samsung",
    "14568E": "Samsung",
    "18227E": "Samsung",
    "1C62B8": "Samsung",
    "206E9C": "Samsung",
    "24920E": "Samsung",
    "28987B": "Samsung",
    "2CBABA": "Samsung",
    "30CBF8": "Samsung",
    "340ABD": "Samsung",
    "34C3AC": "Samsung",
    "38ECE4": "Samsung",
    "3CBBFD": "Samsung",
    "4013D9": "Samsung",
    "5056BF": "Samsung",
    "5440AD": "Samsung",
    "5C0A5B": "Samsung",
    "5CA39D": "Samsung",
    "6C2F2C": "Samsung",
    "78471D": "Samsung",
    "803F5D": "Samsung",
    "84119E": "Samsung",
    "848EDF": "Samsung",
    "8C71F8": "Samsung",
    "9463D1": "Samsung",
    "9852B1": "Samsung",
    "9C02D7": "Samsung",
    "A00BBA": "Samsung",
    "A0821F": "Samsung",
    "A8F274": "Samsung",
    "B0DF3A": "Samsung",
    "B407F9": "Samsung",
    "B8D9CE": "Samsung",
    "CC051B": "Samsung",
    "CC3A61": "Samsung",
    "D0176A": "Samsung",
    "D0DFC7": "Samsung",
    "E4F8EF": "Samsung",
    "F025B7": "Samsung",
    "F4428F": "Samsung",
    "FC19D0": "Samsung",
    # Google
    "001A11": "Google",
    "3C5AB4": "Google",
    "94EB2C": "Google",
    "F4F5D8": "Google",
    "F4F5E8": "Google",
    "54609D": "Google",
    "F8041E": "Google",
    # Amazon
    "000F4C": "Amazon",
    "00FC8B": "Amazon",
    "18742E": "Amazon",
    "34D270": "Amazon",
    "40B4CD": "Amazon",
    "44650D": "Amazon",
    "50F5DA": "Amazon",
    "6854FD": "Amazon",
    "6C5697": "Amazon",
    "747548": "Amazon",
    "78E103": "Amazon",
    "840D8E": "Amazon",
    "88716A": "Amazon",
    "A002DC": "Amazon",
    "AC63BE": "Amazon",
    "B47C9C": "Amazon",
    "F0272D": "Amazon",
    "F0D2F1": "Amazon",
    "FC65DE": "Amazon",
    # Microsoft/Xbox
    "001DD8": "Microsoft",
    "002481": "Microsoft",
    "0025AE": "Microsoft",
    "0050F2": "Microsoft",
    "28187D": "Microsoft",
    "60455E": "Microsoft",
    "7C1E52": "Microsoft",
    # Sony/PlayStation
    "001315": "Sony",
    "0013A9": "Sony",
    "001D0D": "Sony",
    "001FA7": "Sony",
    "002345": "Sony",
    "0024BE": "Sony",
    "002C8A": "Sony",
    "A8E3EE": "Sony",
    "F8D0AC": "Sony",
    # Netgear
    "00146C": "Netgear",
    "001E2A": "Netgear",
    "001F33": "Netgear",
    "00223F": "Netgear",
    "00243F": "Netgear",
    "0026F2": "Netgear",
    "08028E": "Netgear",
    "204E7F": "Netgear",
    "2C3033": "Netgear",
    "6CB0CE": "Netgear",
    "9C3DCF": "Netgear",
    "C03F0E": "Netgear",
    "C43DC7": "Netgear",
    "E4F4C6": "Netgear",
    # TP-Link
    "001D0F": "TP-Link",
    "002127": "TP-Link",
    "14CF92": "TP-Link",
    "14CC20": "TP-Link",
    "1C3BF3": "TP-Link",
    "30B5C2": "TP-Link",
    "503EAA": "TP-Link",
    "5CA6E6": "TP-Link",
    "60E327": "TP-Link",
    "64566D": "TP-Link",
    "6466B3": "TP-Link",
    "788A20": "TP-Link",
    "9CA2F4": "TP-Link",
    "B09575": "TP-Link",
    "C0C9E3": "TP-Link",
    "C46E1F": "TP-Link",
    "C4E984": "TP-Link",
    "D46E0E": "TP-Link",
    "EC086B": "TP-Link",
    "EC172F": "TP-Link",
    "F4EC38": "TP-Link",
    "F81A67": "TP-Link",
    # Cisco
    "000142": "Cisco",
    "0001C7": "Cisco",
    "000A41": "Cisco",
    "000C85": "Cisco",
    "000DBC": "Cisco",
    "000E83": "Cisco",
    "000F8F": "Cisco",
    "001100": "Cisco",
    "001121": "Cisco",
    "00127F": "Cisco",
    "00136C": "Cisco",
    "001442": "Cisco",
    "001562": "Cisco",
    "001678": "Cisco",
    "001795": "Cisco",
    "00188B": "Cisco",
    "001A30": "Cisco",
    "001A6C": "Cisco",
    "001B2A": "Cisco",
    # Intel
    "001111": "Intel",
    "001302": "Intel",
    "001500": "Intel",
    "001517": "Intel",
    "001676": "Intel",
    "0019D1": "Intel",
    "001B21": "Intel",
    "001CC0": "Intel",
    "001DE0": "Intel",
    "001E64": "Intel",
    "001E65": "Intel",
    "001E67": "Intel",
    "001F3B": "Intel",
    "001F3C": "Intel",
    "002170": "Intel",
    "0022FA": "Intel",
    "0022FB": "Intel",
    "0024D6": "Intel",
    "0024D7": "Intel",
    "002314": "Intel",
    "0026C6": "Intel",
    "0026C7": "Intel",
    "3C970E": "Intel",
    "4CEB42": "Intel",
    "502DA2": "Intel",
    "5C514F": "Intel",
    "6036DD": "Intel",
    "64006A": "Intel",
    "7C7A91": "Intel",
    "8086F2": "Intel",
    "88532E": "Intel",
    "8C8D28": "Intel",
    "9059AF": "Intel",
    "94659C": "Intel",
    "A44E31": "Intel",
    "A4C494": "Intel",
    "B4B676": "Intel",
    "C8D719": "Intel",
    "DC536C": "Intel",
    "F8F1E6": "Intel",
    # Raspberry Pi
    "B827EB": "Raspberry Pi",
    "DCA632": "Raspberry Pi",
    "E45F01": "Raspberry Pi",
    # Dell
    "001422": "Dell",
    "0018A4": "Dell",
    "0021D5": "Dell",
    "0025B3": "Dell",
    "00B0D0": "Dell",
    "14187D": "Dell",
    "24B6FD": "Dell",
    "34E6D7": "Dell",
    "5CBA37": "Dell",
    "74867A": "Dell",
    "782BCB": "Dell",
    "C81F66": "Dell",
    "D4BE26": "Dell",
    # HP
    "001083": "HP",
    "0010E3": "HP",
    "001185": "HP",
    "001321": "HP",
    "0014C2": "HP",
    "001635": "HP",
    "001A4B": "HP",
    "001B78": "HP",
    "001CC4": "HP",
    "001E0B": "HP",
    "001F29": "HP",
    "0021F1": "HP",
    "0022B0": "HP",
    "0023B2": "HP",
    "00237D": "HP",
    "002511": "HP",
    "002655": "HP",
    "002712": "HP",
    "0030C1": "HP",
    "080009": "HP",
    "10C37B": "HP",
    "1458D0": "HP",
    "28924A": "HP",
    "2C27D7": "HP",
    "3CA82A": "HP",
    "4437E6": "HP",
    "6C3BE5": "HP",
    "98E7F4": "HP",
    "B499BA": "HP",
    "C8CBB8": "HP",
    # ASUS
    "000C6E": "ASUS",
    "0011D8": "ASUS",
    "001731": "ASUS",
    "001A92": "ASUS",
    "001D60": "ASUS",
    "001E8C": "ASUS",
    "001FC6": "ASUS",
    "00248C": "ASUS",
    "002618": "ASUS",
    "002719": "ASUS",
    "049226": "ASUS",
    "08606E": "ASUS",
    "107B44": "ASUS",
    "14DAE9": "ASUS",
    "1831BF": "ASUS",
    "20CF30": "ASUS",
    "2C56DC": "ASUS",
    "305A3A": "ASUS",
    "3085A9": "ASUS",
    "4CEDFB": "ASUS",
    "5404A6": "ASUS",
    "60A44C": "ASUS",
    "708BCD": "ASUS",
    "74D02B": "ASUS",
    "88D7F6": "ASUS",
    "9C5C8E": "ASUS",
    "AC220B": "ASUS",
    "BCEE7B": "ASUS",
    "D850E6": "ASUS",
    "E03F49": "ASUS",
    "F07959": "ASUS",
    "F46D04": "ASUS",
    # Linksys
    "00045A": "Linksys",
    "000625": "Linksys",
    "000C41": "Linksys",
    "000F66": "Linksys",
    "001217": "Linksys",
    "001310": "Linksys",
    "0014BF": "Linksys",
    "001839": "Linksys",
    "00189D": "Linksys",
    "001A70": "Linksys",
    "001C10": "Linksys",
    "001E13": "Linksys",
    "001EE5": "Linksys",
    "002129": "Linksys",
    "002369": "Linksys",
    "002556": "Linksys",
    # D-Link
    "0005CD": "D-Link",
    "000D88": "D-Link",
    "000F3D": "D-Link",
    "0013A6": "D-Link",
    "001346": "D-Link",
    "001B11": "D-Link",
    "001CF0": "D-Link",
    "001E58": "D-Link",
    "00219C": "D-Link",
    "002401": "D-Link",
    "00265A": "D-Link",
    "14D64D": "D-Link",
    "1CAFF7": "D-Link",
    "1C7EE5": "D-Link",
    "340804": "D-Link",
    "9094E4": "D-Link",
    "BCF685": "D-Link",
    "C4A810": "D-Link",
    # Roku
    "084E81": "Roku",
    "B0A737": "Roku",
    "C83A6B": "Roku",
    "D83134": "Roku",
    "DC3A5E": "Roku",
    # LG
    "0019A1": "LG",
    "001E75": "LG",
    "001F6B": "LG",
    "001F7D": "LG",
    "001FE2": "LG",
    "002426": "LG",
    "0025E5": "LG",
    "00266D": "LG",
    "0026E2": "LG",
    "10F96F": "LG",
    "204C03": "LG",
    "3CCE73": "LG",
    "50557B": "LG",
    "58A2B5": "LG",
    "6CD68A": "LG",
    "78F882": "LG",
    "94D859": "LG",
    "A8D8CF": "LG",
    "B40EDD": "LG",
    "B8C75D": "LG",
    "C01173": "LG",
    "CC2D8C": "LG",
    "E892A4": "LG",
    "F80D43": "LG",
    # Vizio
    "6451C9": "Vizio",
    "8C5877": "Vizio",
    "A83944": "Vizio",
    "B840DFF": "Vizio",
    "CCFAB9": "Vizio",
    "D0C1B1": "Vizio",
    # Sonos
    "000E58": "Sonos",
    "001788": "Sonos",
    "5CAAFD": "Sonos",
    "7CD1C3": "Sonos",
    "949F3E": "Sonos",
    "B8E937": "Sonos",
    "C8DF84": "Sonos",
    # Nest
    "18B430": "Nest",
    "64166A": "Nest",
}


def lookup_vendor(mac_address: str) -> str | None:
    """Look up vendor name from MAC address.

    Args:
        mac_address: MAC address in any common format
                     (e.g., "00:11:22:33:44:55", "00-11-22-33-44-55",
                     or "0:c:8a:91:3e:b3" without leading zeros)

    Returns:
        Vendor name or None if not found
    """
    # Handle MAC addresses with missing leading zeros (e.g., "0:c:8a" -> "00:0c:8a")
    parts = mac_address.replace("-", ":").replace(".", ":").split(":")
    if len(parts) == 6:
        # Pad each part to 2 characters
        normalized = "".join(p.zfill(2) for p in parts).upper()
    else:
        # Fallback: remove separators and uppercase
        normalized = mac_address.upper().replace(":", "").replace("-", "").replace(".", "")

    # Get OUI (first 6 hex characters = 3 bytes)
    if len(normalized) >= 6:
        oui = normalized[:6]
        return OUI_DATABASE.get(oui)

    return None
